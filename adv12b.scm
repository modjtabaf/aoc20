
(if #f
(define input (list
(cons 'F 10)
(cons 'N 3)
(cons 'F 7)
(cons 'R 90)
(cons 'F 11)
))
(define input (list
(cons 'W 4)
(cons 'N 1)
(cons 'F 35)
(cons 'R 90)
(cons 'F 2)
(cons 'N 3)
(cons 'W 4)
(cons 'S 1)
(cons 'R 90)
(cons 'F 89)
(cons 'W 3)
(cons 'N 3)
(cons 'R 90)
(cons 'W 5)
(cons 'F 46)
(cons 'L 90)
(cons 'W 5)
(cons 'L 90)
(cons 'F 15)
(cons 'W 5)
(cons 'N 5)
(cons 'E 1)
(cons 'F 92)
(cons 'N 2)
(cons 'W 5)
(cons 'L 180)
(cons 'F 27)
(cons 'N 4)
(cons 'F 32)
(cons 'R 90)
(cons 'S 5)
(cons 'F 12)
(cons 'E 3)
(cons 'R 90)
(cons 'N 2)
(cons 'F 54)
(cons 'R 180)
(cons 'E 2)
(cons 'L 90)
(cons 'E 1)
(cons 'R 180)
(cons 'F 98)
(cons 'N 5)
(cons 'F 41)
(cons 'S 1)
(cons 'R 180)
(cons 'N 5)
(cons 'F 24)
(cons 'W 5)
(cons 'R 90)
(cons 'S 4)
(cons 'R 180)
(cons 'W 4)
(cons 'R 90)
(cons 'W 3)
(cons 'N 5)
(cons 'E 2)
(cons 'F 69)
(cons 'N 2)
(cons 'R 180)
(cons 'F 48)
(cons 'W 2)
(cons 'N 4)
(cons 'E 5)
(cons 'S 1)
(cons 'W 1)
(cons 'F 39)
(cons 'S 5)
(cons 'L 90)
(cons 'E 4)
(cons 'R 180)
(cons 'E 4)
(cons 'L 180)
(cons 'E 1)
(cons 'R 90)
(cons 'F 97)
(cons 'S 2)
(cons 'L 270)
(cons 'N 5)
(cons 'E 2)
(cons 'R 90)
(cons 'S 1)
(cons 'R 90)
(cons 'E 4)
(cons 'N 4)
(cons 'F 2)
(cons 'N 3)
(cons 'L 90)
(cons 'E 4)
(cons 'F 84)
(cons 'W 5)
(cons 'N 2)
(cons 'E 4)
(cons 'S 2)
(cons 'E 1)
(cons 'S 5)
(cons 'E 2)
(cons 'N 4)
(cons 'E 1)
(cons 'F 94)
(cons 'R 180)
(cons 'N 2)
(cons 'L 90)
(cons 'W 4)
(cons 'L 180)
(cons 'F 82)
(cons 'E 1)
(cons 'L 270)
(cons 'F 14)
(cons 'S 5)
(cons 'S 5)
(cons 'R 90)
(cons 'F 75)
(cons 'R 90)
(cons 'E 5)
(cons 'S 3)
(cons 'R 90)
(cons 'N 2)
(cons 'F 94)
(cons 'L 180)
(cons 'E 4)
(cons 'F 3)
(cons 'E 5)
(cons 'N 3)
(cons 'R 90)
(cons 'N 1)
(cons 'E 1)
(cons 'S 1)
(cons 'R 90)
(cons 'N 4)
(cons 'L 90)
(cons 'E 3)
(cons 'L 270)
(cons 'F 45)
(cons 'E 2)
(cons 'S 2)
(cons 'E 1)
(cons 'F 67)
(cons 'L 90)
(cons 'F 15)
(cons 'N 3)
(cons 'W 4)
(cons 'N 3)
(cons 'R 90)
(cons 'F 51)
(cons 'N 3)
(cons 'S 2)
(cons 'R 90)
(cons 'N 1)
(cons 'L 180)
(cons 'W 3)
(cons 'L 90)
(cons 'W 5)
(cons 'F 8)
(cons 'N 3)
(cons 'F 36)
(cons 'N 2)
(cons 'L 90)
(cons 'S 4)
(cons 'F 91)
(cons 'N 1)
(cons 'E 4)
(cons 'R 90)
(cons 'E 5)
(cons 'L 90)
(cons 'E 2)
(cons 'F 77)
(cons 'R 90)
(cons 'E 4)
(cons 'F 8)
(cons 'W 2)
(cons 'R 90)
(cons 'N 5)
(cons 'R 90)
(cons 'E 5)
(cons 'S 4)
(cons 'W 5)
(cons 'F 68)
(cons 'N 1)
(cons 'F 72)
(cons 'S 3)
(cons 'W 3)
(cons 'F 36)
(cons 'E 5)
(cons 'F 53)
(cons 'E 1)
(cons 'E 1)
(cons 'N 3)
(cons 'W 3)
(cons 'N 5)
(cons 'L 270)
(cons 'S 2)
(cons 'L 180)
(cons 'E 3)
(cons 'S 2)
(cons 'W 1)
(cons 'R 90)
(cons 'E 5)
(cons 'S 1)
(cons 'W 5)
(cons 'N 1)
(cons 'F 16)
(cons 'W 5)
(cons 'N 2)
(cons 'E 2)
(cons 'N 3)
(cons 'F 9)
(cons 'S 3)
(cons 'L 180)
(cons 'F 33)
(cons 'E 2)
(cons 'L 90)
(cons 'R 90)
(cons 'F 13)
(cons 'S 4)
(cons 'W 3)
(cons 'S 5)
(cons 'F 71)
(cons 'N 1)
(cons 'S 2)
(cons 'F 49)
(cons 'E 5)
(cons 'F 3)
(cons 'S 3)
(cons 'L 270)
(cons 'N 4)
(cons 'E 3)
(cons 'R 270)
(cons 'N 2)
(cons 'L 90)
(cons 'F 96)
(cons 'S 3)
(cons 'R 180)
(cons 'F 48)
(cons 'E 3)
(cons 'N 3)
(cons 'F 2)
(cons 'E 1)
(cons 'S 5)
(cons 'F 88)
(cons 'W 4)
(cons 'F 98)
(cons 'E 5)
(cons 'F 45)
(cons 'R 90)
(cons 'N 5)
(cons 'W 5)
(cons 'L 90)
(cons 'S 3)
(cons 'E 1)
(cons 'F 18)
(cons 'E 3)
(cons 'S 1)
(cons 'F 59)
(cons 'L 270)
(cons 'N 4)
(cons 'L 180)
(cons 'W 4)
(cons 'S 2)
(cons 'F 88)
(cons 'L 90)
(cons 'N 4)
(cons 'F 1)
(cons 'L 180)
(cons 'E 4)
(cons 'L 90)
(cons 'W 4)
(cons 'R 180)
(cons 'F 50)
(cons 'L 180)
(cons 'W 5)
(cons 'F 14)
(cons 'S 4)
(cons 'F 6)
(cons 'R 90)
(cons 'E 1)
(cons 'N 5)
(cons 'E 3)
(cons 'F 51)
(cons 'R 90)
(cons 'E 5)
(cons 'R 90)
(cons 'F 78)
(cons 'S 1)
(cons 'W 4)
(cons 'N 2)
(cons 'R 90)
(cons 'F 43)
(cons 'E 2)
(cons 'N 4)
(cons 'R 90)
(cons 'F 44)
(cons 'L 90)
(cons 'F 16)
(cons 'N 2)
(cons 'W 4)
(cons 'S 2)
(cons 'F 53)
(cons 'S 4)
(cons 'W 5)
(cons 'F 30)
(cons 'L 90)
(cons 'E 4)
(cons 'F 87)
(cons 'E 3)
(cons 'L 90)
(cons 'S 1)
(cons 'F 34)
(cons 'W 1)
(cons 'L 90)
(cons 'F 74)
(cons 'S 3)
(cons 'F 4)
(cons 'E 4)
(cons 'N 2)
(cons 'F 34)
(cons 'W 1)
(cons 'L 180)
(cons 'F 57)
(cons 'E 3)
(cons 'R 90)
(cons 'W 4)
(cons 'N 1)
(cons 'R 90)
(cons 'E 3)
(cons 'R 180)
(cons 'F 51)
(cons 'S 2)
(cons 'R 90)
(cons 'S 1)
(cons 'E 4)
(cons 'S 4)
(cons 'F 19)
(cons 'W 3)
(cons 'F 64)
(cons 'E 3)
(cons 'N 1)
(cons 'E 2)
(cons 'L 90)
(cons 'E 3)
(cons 'W 1)
(cons 'S 3)
(cons 'R 90)
(cons 'F 81)
(cons 'E 3)
(cons 'S 5)
(cons 'R 90)
(cons 'F 11)
(cons 'R 90)
(cons 'W 4)
(cons 'N 5)
(cons 'W 2)
(cons 'S 4)
(cons 'W 1)
(cons 'S 4)
(cons 'F 70)
(cons 'L 180)
(cons 'F 75)
(cons 'F 55)
(cons 'S 2)
(cons 'W 3)
(cons 'S 1)
(cons 'L 90)
(cons 'E 3)
(cons 'L 90)
(cons 'W 1)
(cons 'F 41)
(cons 'S 3)
(cons 'L 90)
(cons 'N 5)
(cons 'L 90)
(cons 'W 4)
(cons 'F 6)
(cons 'R 180)
(cons 'E 4)
(cons 'F 37)
(cons 'L 90)
(cons 'F 68)
(cons 'R 90)
(cons 'W 3)
(cons 'F 82)
(cons 'S 5)
(cons 'L 270)
(cons 'S 5)
(cons 'F 86)
(cons 'L 90)
(cons 'F 44)
(cons 'R 90)
(cons 'W 4)
(cons 'R 180)
(cons 'S 3)
(cons 'F 73)
(cons 'L 90)
(cons 'E 5)
(cons 'R 90)
(cons 'E 1)
(cons 'S 3)
(cons 'L 90)
(cons 'F 15)
(cons 'R 90)
(cons 'F 84)
(cons 'L 90)
(cons 'R 90)
(cons 'S 4)
(cons 'W 2)
(cons 'E 3)
(cons 'R 180)
(cons 'F 29)
(cons 'R 90)
(cons 'W 2)
(cons 'F 28)
(cons 'N 4)
(cons 'E 2)
(cons 'N 2)
(cons 'F 66)
(cons 'R 90)
(cons 'E 5)
(cons 'R 90)
(cons 'L 270)
(cons 'S 1)
(cons 'F 34)
(cons 'E 3)
(cons 'S 3)
(cons 'F 57)
(cons 'N 4)
(cons 'S 4)
(cons 'F 27)
(cons 'N 4)
(cons 'W 5)
(cons 'L 180)
(cons 'E 1)
(cons 'S 2)
(cons 'F 8)
(cons 'S 4)
(cons 'E 5)
(cons 'L 180)
(cons 'F 40)
(cons 'L 90)
(cons 'N 5)
(cons 'W 5)
(cons 'N 2)
(cons 'L 270)
(cons 'F 9)
(cons 'E 5)
(cons 'N 2)
(cons 'E 2)
(cons 'L 90)
(cons 'N 4)
(cons 'R 90)
(cons 'S 2)
(cons 'E 2)
(cons 'F 70)
(cons 'E 1)
(cons 'N 2)
(cons 'F 100)
(cons 'L 90)
(cons 'E 1)
(cons 'F 59)
(cons 'L 180)
(cons 'E 3)
(cons 'S 3)
(cons 'L 180)
(cons 'F 97)
(cons 'W 1)
(cons 'F 61)
(cons 'S 1)
(cons 'E 2)
(cons 'N 3)
(cons 'R 90)
(cons 'W 1)
(cons 'E 2)
(cons 'R 90)
(cons 'F 50)
(cons 'S 2)
(cons 'W 5)
(cons 'F 86)
(cons 'S 1)
(cons 'L 90)
(cons 'S 3)
(cons 'F 8)
(cons 'L 90)
(cons 'E 2)
(cons 'F 36)
(cons 'L 180)
(cons 'E 4)
(cons 'R 180)
(cons 'E 3)
(cons 'N 3)
(cons 'E 1)
(cons 'F 94)
(cons 'N 3)
(cons 'F 64)
(cons 'L 90)
(cons 'S 1)
(cons 'S 1)
(cons 'F 33)
(cons 'E 3)
(cons 'S 1)
(cons 'L 90)
(cons 'N 3)
(cons 'W 5)
(cons 'N 4)
(cons 'L 90)
(cons 'F 53)
(cons 'W 1)
(cons 'N 5)
(cons 'F 67)
(cons 'E 2)
(cons 'F 43)
(cons 'N 5)
(cons 'W 3)
(cons 'W 3)
(cons 'L 90)
(cons 'L 90)
(cons 'E 1)
(cons 'S 4)
(cons 'W 3)
(cons 'R 180)
(cons 'S 1)
(cons 'F 79)
(cons 'S 2)
(cons 'W 2)
(cons 'F 23)
(cons 'L 90)
(cons 'W 3)
(cons 'F 65)
(cons 'E 1)
(cons 'R 180)
(cons 'E 4)
(cons 'N 3)
(cons 'L 180)
(cons 'S 4)
(cons 'E 3)
(cons 'E 5)
(cons 'L 90)
(cons 'F 92)
(cons 'W 4)
(cons 'F 57)
(cons 'S 3)
(cons 'L 90)
(cons 'S 2)
(cons 'L 90)
(cons 'S 2)
(cons 'F 50)
(cons 'E 3)
(cons 'L 90)
(cons 'S 3)
(cons 'R 180)
(cons 'E 4)
(cons 'F 14)
(cons 'E 5)
(cons 'S 5)
(cons 'E 3)
(cons 'N 2)
(cons 'L 180)
(cons 'W 4)
(cons 'S 5)
(cons 'S 1)
(cons 'L 90)
(cons 'F 1)
(cons 'S 4)
(cons 'F 4)
(cons 'R 90)
(cons 'S 5)
(cons 'F 15)
(cons 'N 4)
(cons 'L 90)
(cons 'W 3)
(cons 'L 90)
(cons 'S 5)
(cons 'L 270)
(cons 'W 1)
(cons 'R 90)
(cons 'S 3)
(cons 'L 90)
(cons 'W 4)
(cons 'F 16)
(cons 'R 90)
(cons 'S 1)
(cons 'F 61)
(cons 'L 90)
(cons 'N 5)
(cons 'R 90)
(cons 'F 21)
(cons 'R 90)
(cons 'N 4)
(cons 'W 1)
(cons 'F 36)
(cons 'S 1)
(cons 'L 90)
(cons 'W 4)
(cons 'R 90)
(cons 'E 3)
(cons 'N 1)
(cons 'F 68)
(cons 'N 4)
(cons 'E 4)
(cons 'R 90)
(cons 'E 5)
(cons 'S 1)
(cons 'R 90)
(cons 'F 2)
(cons 'R 90)
(cons 'E 3)
(cons 'W 2)
(cons 'R 180)
(cons 'F 13)
(cons 'R 90)
(cons 'S 5)
(cons 'F 99)
(cons 'E 5)
(cons 'R 90)
(cons 'F 8)
(cons 'S 5)
(cons 'F 54)
(cons 'L 90)
(cons 'S 4)
(cons 'R 180)
(cons 'W 2)
(cons 'S 1)
(cons 'F 32)
(cons 'W 3)
(cons 'N 2)
(cons 'W 3)
(cons 'N 3)
(cons 'E 2)
(cons 'N 2)
(cons 'R 180)
(cons 'S 5)
(cons 'E 1)
(cons 'R 90)
(cons 'F 73)
(cons 'L 90)
(cons 'W 4)
(cons 'R 90)
(cons 'S 4)
(cons 'F 29)
(cons 'F 60)
(cons 'L 90)
(cons 'N 5)
(cons 'E 3)
(cons 'N 5)
(cons 'E 1)
(cons 'F 94)
(cons 'N 1)
(cons 'E 5)
(cons 'R 180)
(cons 'N 3)
(cons 'E 2)
(cons 'R 90)
(cons 'W 3)
(cons 'L 180)
(cons 'F 55)
(cons 'N 2)
(cons 'W 2)
(cons 'R 270)
(cons 'F 64)
(cons 'E 5)
(cons 'W 1)
(cons 'N 4)
(cons 'E 4)
(cons 'N 3)
(cons 'E 1)
(cons 'R 90)
(cons 'E 1)
(cons 'S 4)
(cons 'L 270)
(cons 'W 4)
(cons 'S 4)
(cons 'L 180)
(cons 'F 33)
(cons 'R 90)
(cons 'E 5)
(cons 'S 2)
(cons 'W 3)
(cons 'W 5)
(cons 'N 3)
(cons 'W 2)
(cons 'F 20)
(cons 'W 5)
(cons 'S 3)
(cons 'W 3)
(cons 'R 180)
(cons 'F 99)
(cons 'E 1)
(cons 'F 4)
(cons 'E 5)
(cons 'F 34)
(cons 'F 1)
(cons 'F 43)
(cons 'S 4)
(cons 'E 5)
(cons 'R 90)
(cons 'N 5)
(cons 'F 95)
(cons 'W 4)
(cons 'F 10)
(cons 'N 1)
(cons 'L 90)
(cons 'S 4)
(cons 'W 2)
(cons 'L 90)
(cons 'F 41)
(cons 'L 270)
(cons 'F 89)
(cons 'L 90)
(cons 'F 34)
(cons 'N 5)
(cons 'F 2)
(cons 'W 3)
(cons 'F 27)
(cons 'S 1)
(cons 'R 270)
(cons 'W 3)
(cons 'N 2)
(cons 'R 90)
(cons 'F 13)
(cons 'N 1)
(cons 'F 78)
(cons 'W 4)
(cons 'R 90)
(cons 'S 5)
(cons 'F 27)
(cons 'N 5)
(cons 'E 4)
(cons 'F 61)
(cons 'L 180)
(cons 'N 2)
(cons 'R 90)
(cons 'W 5)
(cons 'S 4)
(cons 'S 4)
(cons 'E 1)
(cons 'F 8)
(cons 'R 90)
(cons 'E 2)
(cons 'R 90)
(cons 'E 5)
(cons 'F 1)
(cons 'E 1)
(cons 'L 90)
(cons 'F 32)
(cons 'W 3)
(cons 'S 1)
(cons 'S 3)
(cons 'R 90)
(cons 'E 5)
(cons 'F 84)
(cons 'N 3)
(cons 'F 17)
(cons 'R 90)
(cons 'S 2)
(cons 'F 80)
(cons 'L 90)
(cons 'F 84)
(cons 'S 1)
(cons 'F 63)
(cons 'R 90)
(cons 'N 1)
(cons 'R 90)
(cons 'N 3)
(cons 'F 88)
(cons 'F 16)
(cons 'N 3)
(cons 'W 1)
(cons 'N 5)
(cons 'L 180)
(cons 'S 5)
(cons 'F 66)
(cons 'R 90)
(cons 'W 1)
(cons 'F 85)
(cons 'S 1)
(cons 'F 69)
(cons 'R 180)
(cons 'S 3)
(cons 'F 67)
(cons 'F 69)
(cons 'W 2)
(cons 'F 72)
(cons 'R 180)
(cons 'W 5)
(cons 'F 13)
))
)

;(define DIRS (list 'E 'N 'W 'S))
;(define dir 0)
(define x 0)
(define y 0)
(define wx 10)
(define wy 1)
(define foo)

(for-each
  (lambda (p) (let
    (
      (ins (car p))
      (val (cdr p))
    )
    
    (if (eq? ins 'R) (begin
      (set! ins 'L)
      (set! val (- 360 val))
    ))
    
    (cond
      ((eq? ins 'F)
        (set! x (+ x (* wx val)))
        (set! y (+ y (* wy val)))
      )
      ((eq? ins 'E)
        (set! wx (+ wx val))
      )
      ((eq? ins 'W)
        (set! wx (- wx val))
      )
      ((eq? ins 'N)
        (set! wy (+ wy val))
      )
      ((eq? ins 'S)
        (set! wy (- wy val))
      )
      ((eq? ins 'L)
        (case val
          ((90)
            (set! foo wy)
            (set! wy wx)
            (set! wx (- foo))
          )
          ((180)
            (set! wx (- wx))
            (set! wy (- wy))
          )
          ((270)
            (set! foo wy)
            (set! wy (- wx))
            (set! wx foo)
          )
        )
      )
    )
  ))
  input
)

(pp (+ (abs x) (abs y)))
