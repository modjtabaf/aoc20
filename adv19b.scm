
(if #t
(begin
(define rules (list
(cons 25 (list (list  6 54 )  (list  28 122)))
(cons 52 (list (list  27 54 )  (list  25 122)))
(cons 44 (list (list  118 122 )  (list  30 54)))
(cons 37 (list (list  122 97 )  (list  54 98)))
(cons 38 (list (list  122 22 )  (list  54 3)))
(cons 77 (list (list  54 34 )  (list  122 7)))
(cons 17 (list (list  122 124 )  (list  54 47)))
(cons 1 (list (list  54 79 )  (list  122 119)))
(cons 13 (list (list  122 121 )  (list  54 15)))
(cons 29 (list (list  122 3 )  (list  54 97)))
(cons 24 (list (list  54 97 )  (list  122 62)))
(cons 80 (list (list  122 1 )  (list  54 21)))
(cons 62 (list (list  54 54 )  (list  122 54)))
(cons 5 (list (list  54 61 )  (list  122 119)))
(cons 28 (list (list  54 57 )  (list  122 36)))
(cons 101 (list (list  122 48 )  (list  54 44)))
(cons 81 (list (list  120 54 )  (list  14 122)))
(cons 14 (list (list  54 96 )  (list  122 38)))
(cons 18 (list (list  40 122 )  (list  76 54)))
(cons 27 (list (list  122 93 )  (list  54 103)))
(cons 4 (list (list  123 122 )  (list  90 54)))
(cons 65 (list (list  122 87 )  (list  54 22)))
(cons 113 (list (list  54 )  (list  122)))
(cons 23 (list (list  122 127 )  (list  54 62)))
(cons 117 (list (list  71 54 )  (list  119 122)))
(cons 53 (list (list  35 54 )  (list  126 122)))
(cons 26 (list (list  122 52 )  (list  54 108)))
(cons 125 (list (list  54 33 )  (list  122 4)))
(cons 10 (list (list  74 122 )  (list  53 54)))
(cons 84 (list (list  54 19 )  (list  122 109)))
(cons 123 (list (list  122 114 )  (list  54 115)))
(cons 42 (list (list  70 122 )  (list  26 54)))
(cons 16 (list (list  122 39 )  (list  54 98)))
(cons 63 (list (list  98 54 )  (list  51 122)))
(cons 39 (list (list  54 122)))
(cons 76 (list (list  122 83 )  (list  54 101)))
(cons 61 (list (list  122 3 )  (list  54 39)))
(cons 50 (list (list  122 85 )  (list  54 95)))
(cons 78 (list (list  22 122 )  (list  3 54)))
(cons 114 (list (list  122 122)))
(cons 64 (list (list  122 122 )  (list  122 54)))
(cons 40 (list (list  122 81 )  (list  54 55)))
(cons 92 (list (list  127 122 )  (list  97 54)))
(cons 119 (list (list  122 51)))
(cons 57 (list (list  98 54 )  (list  114 122)))
(cons 3 (list (list  113 122 )  (list  54 54)))
(cons 97 (list (list  122 113 )  (list  54 122)))
(cons 7 (list (list  122 37 )  (list  54 59)))
(cons 74 (list (list  54 46 )  (list  122 56)))
(cons 2 (list (list  122 67 )  (list  54 50)))
(cons 48 (list (list  43 122 )  (list  65 54)))
(cons 124 (list (list  54 94 )  (list  122 36)))
(cons 82 (list (list  54 98 )  (list  122 64)))
(cons 93 (list (list  59 122 )  (list  116 54)))
(cons 96 (list (list  115 122 )  (list  97 54)))
(cons 98 (list (list  54 54)))
(cons 60 (list (list  51 54 )  (list  22 122)))
(cons 72 (list (list  122 98 )  (list  54 3)))
(cons 106 (list (list  39 54 )  (list  39 122)))
(cons 41 (list (list  51 54 )  (list  97 122)))
(cons 31 (list (list  18 54 )  (list  69 122)))
(cons 91 (list (list  122 62 )  (list  54 127)))
(cons 120 (list (list  105 122 )  (list  19 54)))
(cons 56 (list (list  60 122 )  (list  78 54)))
(cons 47 (list (list  16 122 )  (list  91 54)))
(cons 88 (list (list  97 113)))
(cons 30 (list (list  22 122 )  (list  115 54)))
(cons 71 (list (list  51 54 )  (list  39 122)))
(cons 87 (list (list  122 122 )  (list  54 122)))
(cons 21 (list (list  122 102 )  (list  54 73)))
(cons 43 (list (list  122 22 )  (list  54 127)))
(cons 35 (list (list  54 23 )  (list  122 90)))
(cons 51 (list (list  113 113)))
(cons 90 (list (list  122 62 )  (list  54 87)))
(cons 32 (list (list  54 127 )  (list  122 97)))
(cons 115 (list (list  122 54 )  (list  54 113)))
(cons 55 (list (list  54 84 )  (list  122 89)))
(cons 73 (list (list  122 51 )  (list  54 39)))
(cons 36 (list (list  22 54 )  (list  114 122)))
(cons 68 (list (list  122 87 )  (list  54 98)))
(cons 34 (list (list  118 54 )  (list  32 122)))
(cons 95 (list (list  54 87)))
(cons 83 (list (list  122 117 )  (list  54 20)))
(cons 33 (list (list  99 54 )  (list  29 122)))
(cons 19 (list (list  122 127 )  (list  54 98)))
(cons 46 (list (list  54 112 )  (list  122 79)))
(cons 89 (list (list  54 72 )  (list  122 66)))
(cons 110 (list (list  54 51 )  (list  122 98)))
(cons 109 (list (list  64 54 )  (list  22 122)))
(cons 9 (list (list  54 107 )  (list  122 5)))
(cons 12 (list (list  54 80 )  (list  122 45)))
(cons 104 (list (list  54 100 )  (list  122 32)))
(cons 15 (list (list  75 122 )  (list  63 54)))
(cons 69 (list (list  122 49 )  (list  54 12)))
;(cons 8 (list (list  42)))
(cons 8 (list (list  42)  (list  42 42) (list  42 42 42) (list  42 42 42 42) (list  42 42 42 42 42) (list  42 42 42 42 42 42) (list  42 42 42 42 42 42 42) (list  42 42 42 42 42 42 42 42) (list  42 42 42 42 42 42 42 42 42) (list  42 42 42 42 42 42 42 42 42 42)))
(cons 75 (list (list  97 54 )  (list  3 122)))
(cons 108 (list (list  122 77 )  (list  54 125)))
(cons 103 (list (list  122 88 )  (list  54 24)))
(cons 111 (list (list  3 54 )  (list  39 122)))
(cons 70 (list (list  122 58 )  (list  54 10)))
(cons 20 (list (list  122 105 )  (list  54 68)))
(cons 0 (list (list  8 11)))
(cons 122 #\a)
(cons 79 (list (list  62 54 )  (list  22 122)))
(cons 102 (list (list  87 122 )  (list  97 54)))
(cons 105 (list (list  98 54 )  (list  98 122)))
(cons 49 (list (list  13 54 )  (list  2 122)))
(cons 112 (list (list  54 39 )  (list  122 62)))
(cons 58 (list (list  9 122 )  (list  17 54)))
;(cons 11 (list (list  42 31)))
(cons 11 (list (list  42 31 )  (list  42 42 31 31) (list  42 42 42 31 31 31) (list  42 42 42 42 31 31 31 31) (list  42 42 42 42 42 31 31 31 31 31) (list  42 42 42 42 42 42 31 31 31 31 31 31)))
(cons 107 (list (list  66 122 )  (list  110 54)))
(cons 86 (list (list  54 106 )  (list  122 82)))
(cons 99 (list (list  127 122 )  (list  39 54)))
(cons 22 (list (list  54 122 )  (list  122 54)))
(cons 118 (list (list  54 3 )  (list  122 64)))
(cons 67 (list (list  122 59 )  (list  54 111)))
(cons 126 (list (list  78 54 )  (list  92 122)))
(cons 121 (list (list  54 41 )  (list  122 38)))
(cons 66 (list (list  22 113)))
(cons 94 (list (list  54 39)))
(cons 6 (list (list  88 122 )  (list  29 54)))
(cons 127 (list (list  122 54)))
(cons 116 (list (list  54 39 )  (list  122 87)))
(cons 59 (list (list  54 51)))
(cons 85 (list (list  64 122 )  (list  97 54)))
(cons 100 (list (list  98 122 )  (list  62 54)))
(cons 54 #\b)
(cons 45 (list (list  86 122 )  (list  104 54)))
))

(define input (list
"baaabbaabababaaababaaaaababbbabaabbbabba"
"baabbbbbaababbabaaabbabb"
"abbabbaabbabbbaabbabaaaaaabaabbbabbabbaa"
"bababbaababaabbaaabbabbb"
"baaabbaababbbbaabbbaaaba"
"bababbaababbbbbbaabbbbbb"
"ababababbabbaababbaabbbabbaabababaaababbaabaaaabbbbbaaaa"
"bbabbabaaaaabaaabbaabbab"
"abbbaabbababaabbbaabaaab"
"bababaaaabbbbbaaaabbbbbb"
"bbabaabbbbabbaabbabaabbaabbbbbaa"
"babaabaaabaaabbbbbbabbababaaabbbaaaaababbaabaabb"
"abaaaaaabaaabbbabbbaaabaababaabaaabababaaabaabba"
"aabbbaaaababbaaaaababbbb"
"babaabbaaaaabaaabaabbbabbababbbb"
"aabbabbbbbabaaaabbaabbab"
"abbabaaaaaaaaaaaabaabbbbaaabbbabaaabbabb"
"aaababbbaabbabbbaaabaaba"
"babbaabbbabaaaaaaabbbbabbabaabbababbbbabaababbba"
"abababbbabbabbaabaaabbbbababbabb"
"aaaaabbbbbbbaaaabbbaaabb"
"baababaaababaaabbaabaaabaabbabbabbaaaabb"
"babaabbbababaabaaababbbb"
"babaabaababbbbbbaabbaaba"
"babaabbbbabaaaabbbabbbaaaabaaaba"
"bbbabbbabbbbbaabbbbaabba"
"aaaaaababbabbbaaaaabbabb"
"bbabbbaaaababaaaababaaab"
"baabaababbbbbbbaaaaababb"
"abaababbaaaabbbaaabbabababaababbbbaabaab"
"abbbbbaaaababaabbbbababa"
"aabbabababbbbbaabbaaabba"
"abbaaababaabbbaaaabbaaaabbbabbabbababababaaaaaaabaabaabaaaaabaabbaabaaabaababbbbbbaabbaa"
"abbabaaaaaaaababbbbaabba"
"bbabbbaaaaabaababbbbbaaabbaaaabababbbabaabbabaababaaababbaabbbbbaababbbb"
"abbabaabbbbbaababbabbbbaabbaaaab"
"baaaabababaabbabbbbbbaabbaaaaabbbabbbbba"
"abbbabbbbbabaabbaaabaabb"
"aaaaababbbbabbaabaababba"
"baabbbbaaaaabbababababba"
"bbbabbaaabbaaaaaabaabbaa"
"babbaabbbabbaabbaaababababaaabab"
"ababaabbbaaabaaabaaaababbbaababaaababaabbbbbabbaaabbaaaa"
"aabbbabaaaaaabaaaaabbbaa"
"aabaaabbbbbbbbbaaabababa"
"abbaabababbbaabbbabbbbaaaaaaabbaaaababababaabbbabbbababa"
"aabbbabbabbaaaaabbbaaabb"
"bbbabbbabbaabbbbbbbaaaba"
"bbabababaababbaaababbaab"
"abbabbbabbbbbaaaabbabaaabbabaabaababbaaaaaabbabb"
"abbbbaabbabaaababbabaaab"
"aabbbbabaaaabbbaabbaabbbbbaabaaaaaaaaabaaaabbbaabaabaaab"
"abaaabababbbbaabbbbbaaba"
"bbbbbabbbabbbaaabbaababaaaabbabbaaaaaaabaaaaaaaaabbabaaaabbabbaabbbbaaabaaaabbba"
"baabaabaabbbabbbbbaabaaaaaabbbaa"
"bbbaaaaabbbbbbaabbaabaabbbbbbbbbabbababaaabbbbbb"
"bababaabbabaabbabbbbbabababaaabb"
"abaabbabaabaaabbbbaaabba"
"babbaababbabbaababbbbaaa"
"aabaababbabaababaababbbb"
"aaababbaabbaaaaababaaabaaabbbabbbaaabababbbabbbb"
"aaaaaabaabaabbbaabaaabaa"
"babaabababbabaaaaaaababb"
"bbabaabbabaabbbaaaaaaabb"
"abbabbbbbaaabbaaaaabaaab"
"ababaaaabbabbbaabababaaaaababaabbbaabbaaaababbbb"
"babaaaaaababbbbaaabbbaaaabbbbbabbbababba"
"bbbbabbbaababbabaabaabba"
"babbabbbbaaaaabbbabbbaaaabaabaaa"
"aabaaabbaabbbbabbbbababa"
"babbabbaaaababbbaabbaaaa"
"aabaababbaaabbbbbbbaabbb"
"babaaaabbabaabbaabaaabababbaabbbbaaaabbb"
"bbaabbbbbbabbbababbbabba"
"bbbabaabbaabaabababbbaaa"
"bbabaabbbaababbaaaabbbababbaaabaaaaabababaaaabbabbbaaabb"
"ababaabababaabbbbbababaa"
"abbabbaabbbbabababbababb"
"baabbbbaaababbabaaabbaaa"
"ababaabaababababaaabbabb"
"babbbbaaabaabbbababbaaaa"
"aaaabbabbabaaabbbbbaabbb"
"babbababaabbbababbabababbababbba"
"aabbbabbbaaabbaabbbabaaa"
"aaaabbabbbbabbaaaaabbbba"
"aaabbaabaaaaabaababaabbaababaaaababaabababbbaaaababbabaa"
"babbabbabbaabbaaaaabbbbb"
"bbababbbaaaabaaaabbaababbbaabaabaababbbabbbbbbaabbbaababbbbbbaabaaaaabbbaabbbbabaabbbbba"
"aabbbabaaaaaabbbbbaabbaababbaaabaabaabbbaabaabbb"
"bababaababbbbbaaabbaabab"
"baaaaaababaaaaabbabbbbba"
"aaababbabaaaababbbabbbaabbbbaabb"
"bbabbbaabaaaababbaaaaaba"
"abbbbbaaaabbbbababbbaaba"
"bbbababbabbbaabbbbbbabaa"
"abbbbabaabababbbbabaabaabbbaabba"
"bbbbbbbaabbaabaabbbbaaaa"
"bbbbbaaabaabaaaabaababbb"
"abaaababbbbbbaaaaabbbaab"
"abaaaaabbbbaaaabaababbaa"
"baaaababbbabaabbaaabaaab"
"aaababbbaaabbaababaaaaaabbaaaabaaaaabbaa"
"bbabbaabbaaaababbbaababaaabbabba"
"abaaaaabbbbaaaabbaaabaab"
"ababbbaaabbabbabbabbaaab"
"baaabbbbaaabbaababaabbabababbabb"
"abbabbbbbbaaabbbbbaaaabb"
"baabbbaaabbbabbbbababbaabbbbbbbbabbaaaabbbaababbbaaaaabbbabaabbaaababbbbbabaaaba"
"aababbaabbbbbababbbbabbabbababbaabbaabbaaaaaaaab"
"bbbbaaabaaabababbbabbababbbaabab"
"bbaabababbaaabbbaaaababb"
"abbbaabbbaabbaabbaababba"
"aabababbbabbbbaabaaaaaabbbaabbabbabbabbb"
"babbbbbabbbbbbbaaaaaabaaababbbbaaaabbaaa"
"babaabbaaabbabababbbbbbb"
"bbbaabaaabaaaaabbabaaabbaabaabaa"
"babbababaabaababababaabaababaaab"
"bbaaaaababbabbabbbbbaabb"
"babbbabbabaaaabbabaabaaa"
"babbababbaabbaabbbaabaab"
"abbabaabbaaabaaaaabbbabbbbabbabaaababbbbbabaabba"
"bababbaabaabbbabbbabbbbb"
"babbbbbbbaaaaabbbbababaa"
"baaaaaababbabaabbaaaaaba"
"aabababbbbaababaabbaabaaaaaabaaabaababba"
"abaaababbaabbabbaaaaababaabbaabbabbaaaabbbbaababababaaba"
"bbbabbbababbbabbbbbaabaaaababbaababaaaaabaababaaabbaabababbaabab"
"aaababbbbbabaabaababbaab"
"bbbbaaabbbbabbbabbbbaaaa"
"bbbabbababaaababaaaababb"
"baabbbbbbbabaababababaabaabbaaaaaabbabaa"
"abbabbaaaaaabbbaababbbbb"
"bbaabbbbbaaabbbbbbbaabba"
"bbbaaaababbabbabbaababab"
"baaabbaababaabaaabbbabab"
"ababaaaaaabaaabbabaabbaa"
"aababaabbababbaababbababbbaabababaabbabababbabaaaaababaaaabbbaabaabaabaa"
"bbaababababbabbaababaaab"
"aaabababababbbbabbbaabab"
"aabaaaaabaaaaabbaaaaababaaabbaabbaabbbabbaababab"
"bbaaabaaaaabaabbabaaaaba"
"babbbbabbabbbbaaabbaaaaaabbaabbababababb"
"abbbbaabaaababbbbabbabbabbaabaaabbbbbbbbbaaaabaabbaaabab"
"abbaaaaaabbbbabbabaabbbbaaaabababbbbaaba"
"bababaaaababbbbaaaababbaababbaaababaaababababbbbaaabbbba"
"baaabbbbabaaaaabbbbbbbbb"
"bbbbbabbaaaabaabababbbbb"
"ababaaaaaaababbabaaaabba"
"abbbbaabbbaabbbabaaababa"
"abaaababbabababaaabaabaa"
"baaaababaaabaaabbaabaaab"
"abbbbabababbabbaaabbbabbaabaaabaaabababaabbbabab"
"babaaabaaabaabababbaaaab"
"bbabbabbbabbaabbaaaaaabababababbbaabababaaabaababbaabbab"
"abbaabbbbabaabaaaaababaa"
"bbaabbaaaaababbaabbbaabbbbabbabaaabbbababbaabbaaaabbbbaa"
"bbbbababbbbababbbbbabbaaaaaabaabbbbbaabb"
"babbabbbabbabbaaabbbbbaa"
"abababbbbbabbabbabbaaabb"
"bbaabbbabbbbababbbabbaaa"
"baabbabbbbbabbabbbabbbba"
"aabaababbabbbabbbababbbb"
"babbababbbabaababbbaabba"
"aaaabbababbbbaabbbabbabbbabaaabbbaababaabaababbb"
"abbbaabbabbbbbaababababb"
"abbaabaabbbabbaaababbabb"
"baabbabbbaabaaaaaaaaabba"
"bbaabababaaaaaabababaabaabaaaaabaabbbbbbabbbbaaa"
"babaabababbaaaababaababababbbaab"
"aaaaabbbbbabaabbbaababab"
"bbbbbaababbbbaabaaabbaba"
"abbabbaaababaabbbbbaabaabbababab"
"bbbabaabababbbabaaaababa"
"baaabbbababbaababbbbabba"
"aaaabbaabbaabbbabbbbaaaa"
"aabaaabbaabbaabbabbbbbab"
"bbbababbbababbaaabaaabba"
"abbbbbaaabbaaaaaabbaabba"
"babaaaababbbbababaaaabbb"
"baaabbbaaaababbabbbaaaaa"
"bbbababbababbaabbbabbbbb"
"aabbbbababaabbbaabaaaaaa"
"abaababbaaaaabaababbababababbbaaabaaaababbbaabbb"
"babaaaababbaabaabbbbaaaa"
"baabbabbabbbabbbaabaababbabaaaaa"
"babbbbbbabbbabbbaaabbabbaabababaaabaaaba"
"abbabbbaabbaabaabbaaaaaa"
"bbbabbaababbbbaabaaababb"
"abaabbabaababbaabbaaaabb"
"baabbabbbabbbabbabbbaaab"
"abbbbaabbababbaababaaaaaaababbaabbababaa"
"ababababbbbbabababaaaaaa"
"bbbaaaabbabbaabbbabbbabbbbababaa"
"bbbbbbbaabbabbbbbbbabbbb"
"baaaaaababbabbbabbbbbbbaaaaaaabbbaaababb"
"bbabbbababbaaabaaabbabaaabbabbbabbabbbaaababbbab"
"bbabbaabbbaaabbbabaaabbbabaabbaabbaaabba"
"abaaaaabbbaababbababbbabbbbabaabaabbaabbbbababbbababbaaaabaaabaabbaaabaa"
"bbabaabbaabbaabbaabaabbb"
"baabbaaabbabababbaababab"
"bbaababaaabbbaaababbbaba"
"babaaabaabaabaabaaabbaabbaaabbaabaabaaba"
"babaabbabaababaabbbaaaaa"
"bababbaaabababababaaaaba"
"aaaabbabbabbaababbaabbab"
"abbabababaaabbbaaaabaabbbbaabaabbababbbbbbbbaaabbaaababbabbbbaaabbaaabab"
"bababaabaaaabaaaabababbbabbaaaba"
"aabbbbabaabbaabbbbbabaabbaababbabbaaabababbbbbba"
"baabbabaaabbbbabbbaaabaa"
"bbbbbababababaabaaababaa"
"aabaabbaabaaaaabbbbbabababbababb"
"baabbabbaabbbbabbaaababa"
"aababbaabbaabababbaabaab"
"baababaabbbabbbaabaabaab"
"aaaaabaaaaaaaabaaabaaaab"
"abbabbabaabbabbbabaabbbabaababaababbbbbbaaabbaaaabaaabaa"
"aabbbbabbbaabababaababbb"
"aabaababbababaaaabbaabba"
"aabbaabbbabaabaabbabbbbb"
"bababaaaabbbbbaabbbaabbb"
"babbbaaababbbaaaaaaabbbb"
"aabbbabaabbbabaabbbaabbb"
"aaaabbaabbbbabbbbbabaabaabaaabaa"
"abbabbaaabbabbbaabbbaaba"
"ababaabbbbabababaaabbaaa"
"aaabababaaaaabaaaaaaabbbbbbbabababbaaabaabbbaaab"
"baaaababbaababaaabababaa"
"aaaabbaaabbbabbbbaaaabba"
"abaabbbbbaaaaaabaababbaaababbaabaabababa"
"abbabbbbababbbaabaabbaaabbbbbbaabbbbabaa"
"bbabbabbbbabaabbabbbaaab"
"aabbbababbbaaaabaabaabbb"
"bbbabaabbaaabbbbbaabaabb"
"ababaabaaaaaababaaabbaaa"
"baaaaaabbabbabbaabbbaaab"
"bbabaabaababaaaaabbabaaaabababba"
"aabbbaaaaaabbaabbbabbaabbaabaaaa"
"abaaabbbbbaaabbbbaaabbab"
"bbabbabbabaaabbbbabbbbbbabbbbbbaababaaaaabbbbbabaaababbabbbabaababaabbbbabbabbab"
"babaabaababababaaaabbbba"
"bbaabaaababbbbbbbaabaabb"
"baabbbabababaaaaaabbbbaabbbaabab"
"abbbaaaababaabbabaabbbabbabbaaabaaabbaababbbbaaa"
"abbbabaabaababaaabbaaaab"
"ababababaabbbbabbbbbbbabbbbabbbaaaaaaabbbaabbabaabaaaabb"
"abaaabbbabaabbababbaabaaaaaabbbaaaabbbba"
"baaaaabbababababbaaabbab"
"babaaabaaabbbaaabaaabbaa"
"babbbabbbabaabaabbbbbbbb"
"aabbbabbabaaababaaabbabb"
"bbaabbaaaaababbaaabbbaab"
"aabbbbabbbbabbbaaabaaaab"
"abaabbbaababababbabaaabbbabbbaba"
"abbaaaaabbabbbabbbaaabba"
"aabaababbaabbabbabbaabba"
"bbabbabbbabbbbaabaababba"
"bbabaabbbbabaabbbbbbaaaa"
"abbbbabaabbbaabbaaababbaabbbabbaaaaababb"
"bbaaabbbbabaabbaabbbbbbb"
"abaaaabababbaaababbbbbbaababbaab"
"abaabbbbababaaaabbbaaabb"
"aaabaabbaababbbbbbbaaaaaabbbaaba"
"aaaaababbaabbaabbabbabbb"
"aaaaaaabaabababbbbbaaaaa"
"bbbbbaaaababaaaaaaabbaba"
"ababbaaababbbaaaaaabbbba"
"babaabbbbbabababbaabaaab"
"aabbbababbbabaabaabbaaab"
"abbbabaaabbbaabbabbaabba"
"baabbaababaabbabaabaaaab"
"baabbabbaabaababbaababbb"
"bbbaaaabaabbbaaaaaaaaaaabaaabbbaabbaaaaaabbbaababaabababababbaabaaabbbab"
"baabbabaaaaabbaaabbbabba"
"babaaabbabbbaabbabbababa"
"bbabbabbaaababbbbbbaaabb"
"aaaaababbabababaaaaababa"
"babaabbbbbbbbbbababbbbbbbbbaaaabaababaaa"
"aaabababaababbaabaaababa"
"ababaabbbabaabaabbaaaaaa"
"aaaabaaaabbabaaababaabaabababaabbaabbbbbaabbbbba"
"baaaaaabbabaabaabbaababb"
"aaabababaaabababaabaabba"
"abbabaaaabbabbbbbbbbbabbaaaaabab"
"bababaaaaababbabbbbbbbbb"
"ababbaaabbbbababbaaaaaba"
"ababaaaabbbaabaabbaaabaa"
"baaabbaabbbaababbaabaaabaaaaabababaabaaabababaaa"
"aaabbaabbaabbabbbbbababbabaaaababaaabaab"
"bbbbbaaabbaabbaababababb"
"aabbbbabaaaaabbbbaabaabb"
"abbabbaaaabbaabaaaaababbabbabbbaabbbbbbaabbabaaababbaabaaabbabab"
"abbabbababbbbababbbaabaabbbaaababbbaaabb"
"bababbaaabaabbabababaaaaabbbabbbaaaaabbb"
"babbaabaaabbaabbbbaaabaa"
"ababbaaababababaabababbbbbaababaabbbbbbb"
"aababaabbbabbaabababababbbbabbbaaaabaaabaaabbabb"
"baabaaaabababaaaababbbbb"
"bbbbabbbabaaabbbbbbababa"
"bbabbbaaaabbbaaabaababbb"
"bbbabbabbaabbabbbaababbb"
"baabaabaaaaaababaabaaaab"
"aabaabbaabaabbbbaaaabaaabbaababbbbbababbbabbbababaaabaabbaabbaabababaaab"
"babbababbbbababbabbbbbaaaaabbbaa"
"bbaabbbaaabaaabbbaababba"
"bbabbbabbbbabbbabbbbaaababbabaaaababbaabaaabaabbabaaabaa"
"abbaabbbabbbbabbbaaabbaaaabaabba"
"baaaaabbbabaaabababaaabbbabababaaababaaabaaaabbaabbaaababababbbaabbbbaaa"
"babbbaaabaaabbbbbbababba"
"aabbbbabbaabaaaababbabbb"
"baabbbbababbbbbbbbbbaaba"
"baabbbabbbaabaaababbaabbabbbababbbabaaab"
"bbabbbababbabbbbababbaaabababbbbabaabbaa"
"aaabababbbbbababaabababbbbbabbbbbabbbaba"
"bbbbabbbbaabbbabbababaaabbbaaabaabbababb"
"ababbbbaababbbabbbababba"
"abbaaaaabaabaaaabbbbaaba"
"aaababababaabbabbbbbbaaaaaaababa"
"bbbabbbabaaabbbbbbabbaabbbbabaaa"
"bababaabbabbbabbaaabbbaa"
"abbbbabbaaaaabbbbababababbbbabbbaaaaabaaaabbaaaa"
"bbabbbaaaabaaabbaaaabbaabbabaaab"
"abbabaaaaaaaaaaaaaabbabb"
"babbbabbbbabaabaabaaaaba"
"babbaabaabaaabbbbbbbbbaa"
"ababbbbabbbbabbbbababaaaabbaaabbbbbaabba"
"aabaababababaabbbbbaaaaa"
"abbbbbaaabbbbabbaaaababa"
"aaabaaabaabbbaabaabababaaaabaaba"
"babbbabbbbaabaaabababbbbbabbababbaabaabb"
"babaabbbbbbabbabaaaabbbaabaaabaaaabaabba"
"bababaabbabaababbabbbabbbbbbababbabbaaaaaabbabaa"
"babaaaabaababaabbbbaabba"
"bbaabbbbbaaabbbaaabbbbabbbaaaaabbabbabbababbabaabaaabababbabbbba"
"baabbaabbbabbababbbabaaa"
"aaaaaaaaababbbababababbbbbabaaaabaaaaababaabbbbb"
"aaaabaaabaabbbbbbbabbbabbabbabaabbbbaaabaaaabbbbbabaabaa"
"aabaabababbbaabbbbabaabbbbaabababbabbabaaaabaabb"
"aabaababbbabaabababbbbab"
"bbaabbbabbbabbbabbabbbba"
"bbaaaaabaaaabbaaaaaaabba"
"bbaaaaabaababbaababbbabbabbabbaa"
"aaabaabbbabaabaaaaabbbabaabbbbbabbbaabaa"
"aaabbbaabbbbaaabababbbbbabbbbbbbbbbabbbaabbabbbbaaaaaababbbbabbaabbabbaaaababbbb"
"aababaabaabbababbababbba"
"babaaaaaaaaaaaabaabaabba"
"aaabbaabbabbaabbbaabbbbbaabbaaba"
"aaababbabbabbabbababbbbb"
"abaaabbbbbaabaaaabbaaaba"
"bbaababaababbbabaabbbaab"
"abbbaabbbaaabbbabaabbbbbaaaaaaabbaaaaabbbbbbabaaabbaaaba"
"babaaaabbabaaaaababbabaa"
"bbbbaaababbbbaabababbbbb"
"abbababbaabaababbbaaaaabaabaabbbbabbabaababababaaaaaabbababbabbbbabbaaaabbbbabaa"
"babaaababbabaaaabbaaaaba"
"bbabbabaabbbbababbbaaabb"
"bbaababaaaaabbbaaaabbaaa"
"babaaaaaaabaababbabbabbaabababbbaaabbbaaaabbbbbabbbbaaaa"
"babaabbababaaabbbaaaabbb"
"aabaababbabbbabababbbbaabaaabaaaaaabbababbbabaaaabaaaaabaaaababaaabbbaaabbaaabbb"
"abbbabaabbbaaaabaaabaabb"
"bbbbbbbaaaabababaabbbbbb"
"ababaaaabbababababbaaabb"
"abbabbabbabbaabbbaaaaabbaabababa"
"bbabbabaababbbabaaaababb"
"babbabbababaaabbabbaaaba"
"aabbaaababbaaabbbbaabaabbbbabbbaaabbbbababbbabbaaabaaaabaaaabaabaabbbaab"
"bbbbbbbaaabbbabbbbaaaabb"
"bbabbaabbbbaabaabbbaaaaa"
"bbbabaabbaabbaaabaaabaaabbbbbbbb"
"aaabababbaabbbbaaababbbb"
"abbbbbbbabaaaaaaabbbbababbababaa"
"bbbaaaabaabaaaaabbaabbab"
"bbbbabbbaaaababbaabaaaab"
"bbaaabbbababbbabbbbbabaa"
"aaaabbaaabaababbbbabbabbbbbbbaaaabbbbbba"
"aabbbabbaaaaabbbbaaabaab"
"abbabbbbbaaaaaabaaabbaaa"
"baaaabababbbbaabaababaaaabaaabbbbbbaaaababbababa"
"bbbbabbbbbbbabbbbabbabbb"
"abbabaaaaabbaabbabaaaaaa"
"abbabbaaaababbaaababaababbbaabbbabbaaaab"
"abbaabaaaaaaabaaaaabbbaa"
"bbbaaaabbaabaabaaabababa"
"bbbaababbbbabaaabbbabaabaabababa"
"baabaababbabababbbbaaaaa"
"baaaabababbaabbbbaabbbabbbbaabab"
"baabbbbaababbaaaabbaabbb"
"babbbbbbabbbbabbabbabbabaabaaabbaaabbbab"
"ababaabbbabbaabbabaababbbbbbbaba"
"baabbabbaaabababbaabaabb"
"ababababbbabbbabbbababaa"
"abbaababaabbbbbabbaaabbabbabaaab"
"babbbbaaababbbabbbababba"
"abababbbabaaababaabbbbbbbbabbbbbbaaaabbbaabaaababababbba"
"aabbaabbbabaabbbbabbbbab"
"baabbbbabbbbabbbbaaababa"
"aaababbbbbbabbaabbbaaabb"
"bbbaaababaabaaabaababbbabaaaaabaaaabbbaa"
"baaabaabbabbaaabbaaababa"
"bbabaabbaababaaaababbbbb"
"ababbbbababbabbababaabaaaaaaaaababababbbaabbbaab"
"bbbbbabaabbbaabbaaaaabba"
"aaabababbbabbaabbbaabaab"
"bbabbabbbabaabbabaababbb"
"aaaaaaababbabbabbabbabaa"
"abbabaaaaaaaaaaaababbbbb"
"babaababbaabbabbabbabbaabababbbaabaabbaa"
"aabbbbaaaababbbbabababbabbbababa"
"bbbabbaabbabaaaaaaabaaaa"
"bbabbabaabbaaaabbbaaaaaa"
"bbaabaaabbabaaaabbbbaabb"
"bbabbaababbabbaaabbbabbbababbaab"
"bbbbababbabbaabbaabbaaab"
"aaaabbababbabaaababbbbbbbbbbbababbbababbabbbaabaaaabbaba"
"abbbaaaababbbbbaaaabababababbaabaabbbbaabaabaabbbabababa"
"bbbbabbbbbbbabbbbbbbbbab"
"bbabababbbabaaaababababb"
"abbabaaaaaaabbbaaaabbbbb"
"baababaaabababbbbabbaaaa"
"bbabbabbbabbabbaabaaabba"
"aaabababbabaabbaaaabbbbb"
"abaaababbaabbbbaaaaabbaaaaaabaaabbabbbabbbabbbbb"
"bbaaabbbbbbababbabababba"
"bbbbaaabbbabbbabbabaaabbbabaabaaaaaaababbabababbbbbbabaababbabbb"
"babbbabbbaaabbabbbabaaabababbaba"
"bbbabbbbbbabbabbaababbbb"
"baaabaaabbaabbaabaaabbabbababbab"
"bbabaaaaabbabbaaabbabaab"
"abbaabaabaaaaabbbbbaabba"
"aabbbbbaaaabbbbaabaaabbbbbaaabbaaababbbaaabbbaababababbaaabbbaabbbabaaab"
"bbbabbbaabbbbababaaabbabaabaabbbbababbaaaaaaabbbaaabbbabaababbaabbaaabaaabababba"
"aaaaababbbbbbaaaabaababbabbbbabaaaabbaabaabaabbabbabbbbbaaaaabba"
"babbabbabaabbbababaaabaa"
"aabaaaaabbbbaaabababbaab"
"babaaabbbabaabbbaaabaaba"
"bababaaabbaabababbbbaabb"
"aabbbababbaabbbaabbababb"
"babaabaabbbbaabbaaaaabababaaababaababbabbabbabbaabbbbbaababbaabbaaaabaaa"
"aabbbbabaaababbabbaaaaaa"
"ababaabbabaababbbbbaaaaa"
"aaababbbbaabbbabbbabaabbaabbbabaabbaababaaabbaaa"
"bbbbaaabbbaabababaababbb"
"ababababaabababbbbababaa"
"baaabaaaabaaabbbabbbbbaababaaabaabaaaabaaabaabaaaaabaaaa"
"abaabbbabaaabaaaababbbababbbbbaaaabaabaa"
"bbaabaaabbbbbbbbbaaabaaababbbbbabababbaabaaaaaba"
"babbababaabaaaaaaabaabba"
"bbbabaaaabbaabbbaabaabbbaaabababaaababaabbbabaaabbbbaababaaaaaabbabbbaba"
"aabaaaaaaabbabbbaabbbbba"
"abbbbababbabaaaaaaaaaaaaaabbbaaababbabbabbbbabaa"
"aaababbabababaaaabbaabba"
"bbbbabababbabbbaabbbabab"
"aaababbbbaabaaaabbbaabbb"
"bbbaaaabaabaaabbbbaaabab"
"ababbbaabaabaabababbbbab"
"babaabababbabbbbbbbbabba"
"abbbabbbabaaabbaaaaaabbbabababbabaaaaaab"
"baaabbbbbababaababbbbbbb"
"aabbbaaaaabaaaaaabbababb"
"aaaaabaaabababababbbbaaa"
"ababaabbaaaabbababaaaaaa"
"bbbaaaabaaaabbaabaaabaab"
"baaabbbbbbbabbaaabbaaaaababbabbbbbbaabbbbbbabbbabbbaaaab"
"bbbbbaabaaaabbabaaaaaaaabbbabbbb"
"bbbaabaaaabbabbbabbaabaaaaabbbbbabbababbaabbbababbababab"
"bbabbabbbaabbaaaabbabbaaabbbabaababbabbaaaabbbab"
"baaabbbababbbabbaabaabbb"
"aaaabbaababababaaabbbbbb"
"abbbbbaabbbabaabbababbba"
"bbbbbbbababbaabbabaaabba"
"abbbaabbbabaababbbaaaaabaabbbbaa"
"babbaabaabbbbababaaabbab"
"baaabbbabaabbbbabbbbaaabaaabbabb"
"aabbbabbabbbbabbababaabababaabaabbaaabaabbbbbbbbaabababa"
"bbbaabaaababaaaabbaabbaaaabbbabaabababaa"
"bababbaababbababaabbabaa"
))
)
(begin
(define rules (list
(cons 42 (list (list 9 14 )  (list 10 1)))
(cons 9 (list (list 14 27 )  (list 1 26)))
(cons 10 (list (list 23 14 )  (list 28 1)))
(cons 1 #\a)
;(cons 11 (list (list 42 31)))
(cons 11 (list (list  42 31 ) (list  42 42 31 31) (list  42 42 42 31 31 31) (list  42 42 42 42 31 31 31 31) (list  42 42 42 42 42 31 31 31 31 31) (list  42 42 42 42 42 42 31 31 31 31 31 31) (list  42 42 42 42 42 42 42 31 31 31 31 31 31 31)
))
(cons 5 (list (list 1 14 )  (list 15 1)))
(cons 19 (list (list 14 1 )  (list 14 14)))
(cons 12 (list (list 24 14 )  (list 19 1)))
(cons 16 (list (list 15 1 )  (list 14 14)))
(cons 31 (list (list 14 17 )  (list 1 13)))
(cons 6 (list (list 14 14 )  (list 1 14)))
(cons 2 (list (list 1 24 )  (list 14 4)))
(cons 0 (list (list 8 11)))
(cons 13 (list (list 14 3 )  (list 1 12)))
(cons 15 (list (list 1 )  (list 14)))
(cons 17 (list (list 14 2 )  (list 1 7)))
(cons 23 (list (list 25 1 )  (list 22 14)))
(cons 28 (list (list 16 1)))
(cons 4 (list (list 1 1)))
(cons 20 (list (list 14 14 )  (list 1 15)))
(cons 3 (list (list 5 14 )  (list 16 1)))
(cons 27 (list (list 1 6 )  (list 14 18)))
(cons 14 #\b)
(cons 21 (list (list 14 1 )  (list 1 14)))
(cons 25 (list (list 1 1 )  (list 1 14)))
(cons 22 (list (list 14 14)))
;(cons 8 (list (list 42)))
(cons 8 (list (list  42) (list  42 42) (list  42 42 42) (list  42 42 42 42) (list  42 42 42 42 42) (list  42 42 42 42 42 42) (list  42 42 42 42 42 42 42) (list  42 42 42 42 42 42 42 42) (list  42 42 42 42 42 42 42 42 42) (list  42 42 42 42 42 42 42 42 42 42)
))
(cons 26 (list (list 14 22 )  (list 1 20)))
(cons 18 (list (list 15 15)))
(cons 7 (list (list 14 5 )  (list 1 21)))
(cons 24 (list (list 14 1)))
))

(define input (list
"abbbbbabbbaaaababbaabbbbabababbbabbbbbbabaaaa"
"bbabbbbaabaabba"
"babbbbaabbbbbabbbbbbaabaaabaaa"
"aaabbbbbbaaaabaababaabababbabaaabbababababaaa"
"bbbbbbbaaaabbbbaaabbabaaa"
"bbbababbbbaaaaaaaabbababaaababaabab"
"ababaaaaaabaaab"
"ababaaaaabbbaba"
"baabbaaaabbaaaababbaababb"
"abbbbabbbbaaaababbbbbbaaaababb"
"aaaaabbaabaaaaababaa"
"aaaabbaaaabbaaa"
"aaaabbaabbaaaaaaabbbabbbaaabbaabaaa"
"babaaabbbaaabaababbaabababaaab"
"aabbbbbaabbbaaaaaabbbbbababaaaaabbaaabba"
))
))

(define (eval-rule ids lst)
  ;(format "rules ~a on ~s\n" ids (list->string lst))
  (if (null? ids)
    ; then
    (null? lst) ; return true if both are empty, false otherwise
    ; else
    (if (null? lst)
      ; then
      #f
      ; else
      (let
        (
          (my-rules (cdr (assoc (car ids) rules)))
        )

        ;(format "my rules ~a\n" my-rules)
        (if (pair? my-rules)
          ; then, recursion
          (let
            (
              (found? #f)
            )
            
            (for-each
              (lambda (rule)
                (if (not found?) (let
                  (
                    (new-ids (cdr ids))
                  )
                  (for-each
                    (lambda (id)
                      (set! new-ids (cons id new-ids))
                    )
                    (reverse rule)
                  )
                  (set! found? (eval-rule new-ids lst))
                ))
              )
              my-rules
            )
            
            found? ; return value
          )
          ; else
          (and (equal? my-rules (car lst)) (eval-rule (cdr ids) (cdr lst)))
        )
      )
    )
  )
)

(pp (eval-rule (cadr (assoc 0 rules)) (string->list (car input))))

(define total 0)

(for-each
  (lambda (str)
    (if (eval-rule (cadr (assoc 0 rules)) (string->list str)) (begin
      ;(pp str)
      (set! total (1+ total))
    ))
  )
  input
)

(pp total)
